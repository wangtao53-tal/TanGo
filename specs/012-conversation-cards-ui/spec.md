# Feature Specification: 对话页三张卡片生成页面美化

**Feature Branch**: `dev-mvp-20251218`  
**Created**: 2025-12-20  
**Status**: Draft  
**Input**: User description: "前端-对话页-三张卡片的生成页面美化，保证不出现滚轮，自动将内容卡片撑开固定比例，移动端优先，另外卡片的字体采用贴合儿童，字体样式这种儿童产品成败的关键点之一。另外卡片页面三张卡片一下子出来感觉页面被拉的很长，可以先生成第一张 主体介绍，移动端，左滑文言文，右滑英语学习，PC 端如果可以，可以一并展开，支持卡片收藏，支持长按卡片保存到本地。"

**Clarification**: 页面整体布局不要变化，需要做的是交互优化，更加美观，更加贴合孩子使用，无论是字体、色彩、交互等。

**Note**: MVP版本阶段，所有开发工作统一在 `dev-mvp-20251218` 分支进行，不采用一个功能一个分支的策略。

## Scope & Constraints

### 保持不变的部分

- **页面整体布局结构**：保持现有的页面布局（Header、ConversationList、底部输入栏等）不变
- **页面路由和导航**：保持现有的页面跳转逻辑不变
- **消息列表结构**：保持ConversationList组件的整体结构不变
- **输入功能**：保持现有的文本、语音、图片输入功能不变

### 优化的部分

- **卡片展示方式**：优化卡片在对话列表中的展示，实现渐进式显示和滑动切换
- **卡片视觉设计**：优化卡片的字体、色彩、间距等视觉元素，使其更贴合儿童使用
- **卡片交互体验**：优化卡片的交互方式（滑动、收藏、保存），使其更符合儿童操作习惯
- **卡片内容适配**：优化卡片内容的自动适配，确保在固定比例内完整显示，避免滚动

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 卡片内容自适应显示 (Priority: P1)

用户在对话页面查看生成的知识卡片时，卡片内容能够自动适配屏幕高度，在固定比例内完整显示所有内容，无需在卡片内部滚动，提供沉浸式的学习体验。页面整体布局保持不变，仅优化卡片本身的展示方式。

**Why this priority**: 卡片内容的自适应显示是移动端优先设计的关键要求，能够确保用户专注于卡片内容，避免因滚动操作打断学习流程，提升用户体验。同时保持页面整体布局不变，确保用户熟悉的使用习惯不受影响。

**Independent Test**: 可以独立测试：用户在对话页面触发卡片生成后，无论卡片内容多少，卡片都能自动调整到合适的尺寸，确保所有内容在卡片可视区域内完整显示，无需在卡片内部滚动。页面整体布局（Header、消息列表、输入栏）保持不变。这个功能可以独立工作，即使没有其他对话功能，用户也能获得良好的卡片浏览体验。

**Acceptance Scenarios**:

1. **Given** 用户在对话页面，**When** 系统生成知识卡片，**Then** 卡片内容自动适配屏幕高度，按固定比例（如16:9）撑开，卡片内部不出现滚动条，页面整体布局保持不变
2. **Given** 卡片内容长度不同（短内容、中等内容、长内容），**When** 卡片渲染完成，**Then** 所有卡片都能在固定比例内完整显示，内容通过字体大小、行高、间距等自动调整适应
3. **Given** 用户在移动端设备上查看卡片，**When** 屏幕高度有限（如小屏手机），**Then** 卡片仍然能够在固定比例内完整显示，不出现卡片内部滚动条，内容通过合理的字体大小和间距调整适应屏幕，页面整体布局保持不变

---

### User Story 2 - 渐进式卡片展示 (Priority: P1)

系统先生成并显示第一张主体介绍卡片（科学认知卡），用户可以通过滑动操作查看其他卡片（文言文卡片、英语学习卡片），避免三张卡片同时出现导致页面过长的问题。

**Why this priority**: 渐进式展示能够减少页面初始加载时的视觉冲击，让用户专注于当前卡片内容，通过交互式滑动发现更多内容，提升学习体验的连贯性。

**Independent Test**: 可以独立测试：用户在对话页面触发卡片生成后，系统首先显示第一张科学认知卡，用户可以通过左滑查看文言文卡片，右滑查看英语学习卡片。这个功能可以独立工作，即使没有其他对话功能，用户也能通过滑动操作浏览所有卡片。

**Acceptance Scenarios**:

1. **Given** 用户在对话页面触发卡片生成，**When** 系统开始生成三张卡片，**Then** 首先显示第一张科学认知卡（主体介绍），其他两张卡片处于待显示状态
2. **Given** 用户在移动端查看第一张卡片，**When** 用户向左滑动，**Then** 显示文言文卡片（古诗词卡片），滑动动画流畅自然
3. **Given** 用户在移动端查看第一张卡片，**When** 用户向右滑动，**Then** 显示英语学习卡片，滑动动画流畅自然
4. **Given** 用户在PC端查看卡片，**When** 屏幕宽度足够，**Then** 三张卡片可以一并展开显示，或者提供切换视图的选项
5. **Given** 用户正在查看某张卡片，**When** 系统完成其他卡片的生成，**Then** 新生成的卡片可以立即通过滑动访问，无需刷新页面

---

### User Story 3 - 儿童友好视觉设计 (Priority: P1)

卡片内容采用贴合儿童的视觉设计，包括儿童友好的字体样式（字体大小、行高、字间距）、色彩搭配、交互反馈等，确保视觉元素清晰易读、色彩活泼有趣、交互反馈及时明确，符合儿童使用习惯，提升学习效果。

**Why this priority**: 视觉设计（字体、色彩、交互）是儿童产品成败的关键点之一，合适的视觉设计直接影响儿童的阅读体验和学习效果，是产品差异化的核心要素。儿童友好的设计能够降低学习门槛，提升学习兴趣。

**Independent Test**: 可以独立测试：用户在对话页面查看生成的卡片，卡片中的文字采用儿童友好的字体样式（较大的字号、合适的行高、清晰的字体），色彩搭配活泼有趣，交互反馈及时明确，确保8-12岁儿童能够轻松阅读和操作。这个功能可以独立工作，即使没有其他功能，用户也能感受到视觉设计的专业性。

**Acceptance Scenarios**:

1. **Given** 用户在对话页面查看卡片，**When** 卡片内容渲染完成，**Then** 卡片中的标题、正文、说明文字都采用儿童友好的字体样式，字号适中（不小于14px），行高舒适（不小于1.6倍字号），字间距适中，字体采用圆润、清晰的字体（如圆体、幼圆等）
2. **Given** 卡片包含不同层级的内容（标题、正文、注释），**When** 内容显示，**Then** 不同层级使用不同的字号、字重和颜色，形成清晰的视觉层次，色彩搭配活泼有趣但不刺眼
3. **Given** 用户在移动端查看卡片，**When** 屏幕尺寸较小，**Then** 字体大小自动调整，但仍保持儿童友好的可读性，不小于最小字号限制，色彩对比度保持清晰
4. **Given** 卡片包含中英文混合内容，**When** 内容显示，**Then** 中文字体采用适合儿童的字体（如圆润、清晰的字体），英文字体也采用易读的字体样式，中英文混排自然流畅
5. **Given** 用户与卡片交互（点击、滑动、收藏），**When** 交互操作发生，**Then** 提供及时明确的视觉反馈（如按钮高亮、动画效果、状态变化），反馈动画流畅自然，符合儿童认知习惯
6. **Given** 卡片使用色彩元素，**When** 卡片显示，**Then** 色彩搭配活泼有趣，符合儿童审美，同时保持足够的对比度确保可读性，避免过于刺眼或过于暗淡

---

### User Story 4 - 卡片收藏功能 (Priority: P2)

用户可以在卡片页面直接收藏感兴趣的卡片，收藏状态实时更新，用户可以在收藏页面查看已收藏的卡片。

**Why this priority**: 收藏功能让用户能够保存有价值的学习内容，方便后续复习和回顾，是提升用户粘性的重要功能。

**Independent Test**: 可以独立测试：用户在对话页面查看卡片时，点击卡片上的收藏按钮，卡片被收藏，收藏状态更新，用户可以在收藏页面查看已收藏的卡片。这个功能可以独立工作，即使没有其他功能，用户也能完成收藏操作。

**Acceptance Scenarios**:

1. **Given** 用户在对话页面查看卡片，**When** 用户点击卡片上的收藏按钮，**Then** 卡片被收藏，收藏按钮状态更新为已收藏状态，显示视觉反馈
2. **Given** 用户已收藏某张卡片，**When** 用户再次点击收藏按钮，**Then** 卡片取消收藏，收藏按钮状态更新为未收藏状态
3. **Given** 用户收藏了卡片，**When** 用户进入收藏页面，**Then** 已收藏的卡片显示在收藏列表中，可以正常查看和操作

---

### User Story 5 - 长按保存卡片到本地 (Priority: P2)

用户可以通过长按卡片将卡片保存为图片到本地设备，方便分享和离线查看。

**Why this priority**: 保存到本地功能让用户能够将学习内容保存下来，方便分享给他人或离线查看，提升产品的实用价值。

**Independent Test**: 可以独立测试：用户在对话页面长按卡片，系统将卡片内容转换为图片并保存到本地设备，用户可以在相册或文件管理器中找到保存的图片。这个功能可以独立工作，即使没有其他功能，用户也能完成保存操作。

**Acceptance Scenarios**:

1. **Given** 用户在移动端查看卡片，**When** 用户长按卡片（持续按压超过500毫秒），**Then** 显示保存选项菜单或直接触发保存操作
2. **Given** 用户触发保存操作，**When** 系统将卡片转换为图片，**Then** 图片质量清晰，包含完整的卡片内容（文字、图片、样式），保存到设备相册或下载文件夹
3. **Given** 用户在PC端查看卡片，**When** 用户右键点击卡片或使用快捷键，**Then** 显示保存选项，可以将卡片保存为图片文件
4. **Given** 用户保存卡片，**When** 保存操作完成，**Then** 显示成功提示，告知用户保存位置

---

### Edge Cases

- 当卡片内容过长时，如何在固定比例内完整显示所有内容？
- 当用户在滑动过程中快速切换卡片时，如何确保动画流畅不卡顿？
- 当用户设备不支持触摸滑动时（如部分PC设备），如何提供替代的切换方式？
- 当卡片生成失败或部分失败时，已显示的卡片如何保持正常显示？
- 当用户收藏卡片后，卡片数据如何与收藏页面同步？
- 当用户保存卡片时，如果设备存储空间不足，如何处理？
- 当卡片包含图片时，保存到本地时图片质量如何保证？
- 当用户在卡片生成过程中滑动查看其他卡片时，如何显示加载状态？

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 系统必须保持页面整体布局结构不变（Header、ConversationList、底部输入栏等），仅优化卡片本身的展示方式
- **FR-002**: 系统必须确保卡片内容在固定比例内完整显示，卡片内部不出现滚动条，所有内容在卡片可视区域内可见
- **FR-003**: 系统必须自动将卡片内容撑开到固定比例（如16:9或4:3），通过字体大小、行高、间距等调整确保内容完整显示
- **FR-004**: 系统必须优先适配移动端显示，确保在小屏设备上也能完整显示卡片内容
- **FR-005**: 系统必须采用儿童友好的字体样式，包括合适的字号（不小于14px）、行高（不小于1.6倍字号）、字间距，字体采用圆润、清晰的字体（如圆体、幼圆等）
- **FR-006**: 系统必须采用儿童友好的色彩搭配，色彩活泼有趣但不刺眼，保持足够的对比度确保可读性
- **FR-007**: 系统必须提供及时明确的交互反馈（按钮高亮、动画效果、状态变化），反馈动画流畅自然，符合儿童认知习惯
- **FR-008**: 系统必须首先显示第一张科学认知卡（主体介绍），其他两张卡片待显示
- **FR-009**: 系统必须在移动端支持左滑查看文言文卡片，右滑查看英语学习卡片
- **FR-010**: 系统必须在PC端支持三张卡片一并展开显示（当屏幕宽度足够时）
- **FR-011**: 系统必须支持卡片收藏功能，用户可以通过点击收藏按钮收藏或取消收藏卡片
- **FR-012**: 系统必须支持长按卡片保存到本地功能，将卡片转换为图片并保存到设备
- **FR-013**: 系统必须确保卡片滑动动画流畅自然，响应时间在100毫秒内
- **FR-014**: 系统必须确保卡片字体在不同设备上都能清晰显示，自动适配屏幕尺寸
- **FR-015**: 系统必须支持卡片内容的渐进式加载，新生成的卡片可以立即通过滑动访问

### Key Entities *(include if feature involves data)*

- **知识卡片（KnowledgeCard）**：包含卡片类型（science/poetry/english）、卡片内容、收藏状态等信息
- **卡片显示状态（CardDisplayState）**：记录当前显示的卡片索引、卡片生成状态、滑动状态等
- **视觉设计配置（VisualDesignConfig）**：包含字体配置（字号、行高、字间距、字体族）、色彩配置（主色调、辅助色、对比度）、交互反馈配置（动画效果、反馈时长）等儿童友好设计配置
- **收藏记录（CollectionRecord）**：记录用户收藏的卡片信息，与卡片数据关联

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 页面整体布局结构保持不变率100%，所有布局元素（Header、消息列表、输入栏）位置和结构不变
- **SC-002**: 100%的卡片内容在固定比例内完整显示，卡片内部不出现滚动条，内容完整显示率100%
- **SC-003**: 卡片内容自动撑开到固定比例的成功率达到100%，内容通过字体、间距等调整完整显示
- **SC-004**: 移动端卡片滑动操作的响应时间≤100毫秒，滑动动画流畅度评分≥4.5/5.0
- **SC-005**: 卡片字体可读性测试中，8-12岁儿童能够轻松阅读的比例≥95%，字体样式符合儿童阅读习惯
- **SC-006**: 卡片色彩搭配评分≥4.5/5.0（由儿童用户测试），色彩对比度符合WCAG 2.1 AA级标准（≥4.5:1）
- **SC-007**: 卡片交互反馈响应时间≤200毫秒，反馈动画流畅度评分≥4.5/5.0，交互反馈明确性评分≥4.5/5.0
- **SC-008**: 卡片收藏操作的响应时间≤300毫秒，收藏状态更新准确率100%
- **SC-009**: 卡片保存到本地的成功率≥98%，保存的图片质量清晰度评分≥4.0/5.0
- **SC-010**: PC端三张卡片一并展开时，布局适配成功率100%，无内容重叠或溢出
- **SC-011**: 渐进式卡片展示功能中，第一张卡片显示时间≤2秒，后续卡片生成后可立即访问

## Assumptions

- 页面整体布局结构（Header、ConversationList、底部输入栏）保持不变，仅优化卡片组件内部的展示和交互
- 卡片内容通过流式API生成，支持渐进式加载
- 前端已实现卡片组件（ScienceCard、PoetryCard、EnglishCard），只需优化展示方式、视觉设计和交互体验
- 设备支持触摸滑动操作（移动端）或鼠标操作（PC端）
- 浏览器支持Canvas API或类似API用于将卡片转换为图片
- 设备有足够的存储空间保存卡片图片
- 字体文件已准备或可以使用系统字体实现儿童友好效果（如圆体、幼圆等）
- 色彩方案符合儿童审美，同时满足可访问性要求
- 交互反馈动画库已准备或可以使用CSS动画实现
- 收藏功能的后端存储已实现，前端只需调用API

## Non-Functional Requirements

- **性能要求**：卡片滑动响应时间≤100毫秒，卡片渲染时间≤500毫秒，保存图片生成时间≤2秒，交互反馈响应时间≤200毫秒
- **可用性要求**：移动端滑动操作成功率≥98%，PC端展开显示适配成功率100%，字体可读性评分≥4.5/5.0，交互反馈明确性评分≥4.5/5.0
- **响应式要求**：支持320px-1920px宽度的设备，卡片在不同尺寸下都能完整显示，页面整体布局保持响应式适配
- **可访问性要求**：字体大小符合WCAG 2.1 AA级标准，最小字号不小于14px，色彩对比度≥4.5:1，交互元素有明确的视觉反馈
- **儿童友好性要求**：字体样式符合儿童阅读习惯（圆润、清晰），色彩搭配活泼有趣但不刺眼，交互反馈及时明确，动画流畅自然
- **兼容性要求**：支持iOS Safari、Android Chrome、桌面Chrome、桌面Safari等主流浏览器
- **布局稳定性要求**：页面整体布局结构保持不变，不影响现有功能的正常使用

