<!--
Sync Impact Report:
Version: 1.0.0 → 2.0.0 (重大更新)
新增原则:
  - 原则一：中文优先规范
  - 原则二：K12教育游戏化设计规范
  - 原则三：可发布应用规范
  - 原则四：多语言和年级设置规范
  - 原则五：AI优先（模型优先）规范
  - 原则六：移动端优先规范
模板更新状态:
  - ⚠️ .specify/templates/spec-template.md (模板结构保持英文，实际生成内容需遵循中文规范)
  - ✅ .specify/templates/plan-template.md (已更新 Constitution Check 部分)
  - ⚠️ .specify/templates/tasks-template.md (模板结构保持英文，实际生成内容需遵循中文规范)
-->

# TanGo 项目规范

**版本**: 2.0.0  
**批准日期**: 2025-12-18  
**最后修订日期**: 2025-12-18

## 核心原则

### 原则一：中文优先规范 (NON-NEGOTIABLE)

所有项目文档（Markdown 文件）必须以中文编写。模型生成的内容，除非技术限制必须使用英文（如代码标识符、API 端点名称等），否则必须使用中文生成。

**理由**：确保项目文档的一致性和可读性，便于中文用户理解和使用。

**具体要求**：
- 所有 `.md` 文件内容必须使用中文
- 代码注释优先使用中文
- 用户界面文本必须使用中文
- 技术术语在首次出现时可附加英文原文，后续使用中文

### 原则二：K12 教育游戏化设计规范 (NON-NEGOTIABLE)

项目是面向 K12 中小学生（3-12 岁）的 Web 应用，核心思想是"玩中学"。设计必须：

- **目标用户**：以儿童为切入点，考虑儿童的认知水平和操作习惯
- **设计风格**：不要过于华丽，保持简洁有趣
- **交互体验**：具有游戏玩乐的感觉，让学习过程充满趣味
- **教育目标**：在课外探索丰富知识的同时，学习课本上的内容
- **平衡性**：既要激发探索兴趣，又要与课程内容有机结合

**理由**：确保产品符合目标用户群体的特点，实现寓教于乐的教育目标。

**具体要求**：
- UI/UX 设计必须考虑儿童友好性（大按钮、清晰图标、简单操作流程）
- 交互设计应包含游戏化元素（奖励、进度、成就等）
- 内容设计需平衡趣味性和教育性
- 避免过度复杂或成人化的设计元素

### 原则三：可发布应用规范 (NON-NEGOTIABLE)

实现的应用必须是可以使用、可以发布的生产级应用。

**理由**：确保项目具有实际价值，能够真正服务于目标用户。

**具体要求**：
- 应用必须能够正常运行，无阻塞性错误
- 必须考虑性能、安全性和可维护性
- 必须包含必要的错误处理和用户反馈机制
- 必须考虑部署和发布流程
- 代码质量必须达到可维护标准

### 原则四：多语言和年级设置规范 (NON-NEGOTIABLE)

支持中英文设置，支持用户年级设置（K12，小学、初中），支持系统设置，默认Web所有都是中文。

**理由**：满足不同用户的语言需求，根据年级提供适配的内容难度，确保教育内容的针对性。

**具体要求**：
- **语言设置**：
  - 系统默认语言为中文
  - 支持用户切换中英文界面
  - 所有Web界面默认显示中文
  - 语言设置应持久化保存（本地存储）
- **年级设置**：
  - 支持K12年级选择（K1-K12，或小学、初中、高中）
  - 支持细分：小学（1-6年级）、初中（7-9年级）
  - 年级设置影响内容难度和知识卡片生成
  - 首次使用时必须选择年级，后续可修改
- **系统设置**：
  - 提供统一的设置入口
  - 设置项包括：语言、年级、其他偏好设置
  - 设置变更立即生效，无需重启应用

### 原则五：AI优先（模型优先）规范 (NON-NEGOTIABLE)

所有AI相关功能（图片识别、文字识别、继续追问等）都统一通过后端调用模型处理，支持流式返回文字和图片内容。

**理由**：确保AI能力的一致性、可维护性和可扩展性，提供流畅的实时交互体验。

**具体要求**：
- **统一后端调用**：
  - 所有AI模型调用必须通过后端API实现
  - 前端不直接调用AI模型服务
  - 后端统一管理模型配置、API密钥和调用逻辑
- **流式返回支持**：
  - 支持流式返回文字内容（Streaming Text）
  - 支持流式返回图片内容（Streaming Image）
  - 前端实现流式数据接收和实时渲染
  - 提供加载状态和进度反馈
- **AI功能范围**：
  - 图片识别：物体识别、场景理解等
  - 文字识别：OCR、文本理解等
  - 继续追问：多轮对话、上下文理解等
  - 知识卡片生成：基于识别结果的智能内容生成
- **技术实现**：
  - 使用WebSocket或Server-Sent Events (SSE)实现流式传输
  - 后端使用eino框架统一管理AI模型调用
  - 支持多种AI模型（GPT-4、Claude等）的统一接口
  - 实现错误重试和降级策略

### 原则六：移动端优先规范 (NON-NEGOTIABLE)

确保移动端交互的完整性，所有页面UI交互都需要支持点击操作，所有页面有一个统一入口，一键支持拍照，可以随时随地探索。

**理由**：移动端是K12用户的主要使用场景，必须确保移动端体验的完整性和便捷性。

**具体要求**：
- **移动端交互**：
  - 所有UI元素必须支持点击操作（touch事件）
  - 按钮、卡片、链接等交互元素必须有足够的点击区域（最小44x44px）
  - 避免hover-only的交互，所有功能必须通过点击触发
  - 支持手势操作（滑动、长按等）作为辅助交互方式
- **统一拍照入口**：
  - 所有页面必须有一个统一的拍照入口
  - 拍照按钮应固定在页面底部或顶部，易于访问
  - 支持一键快速拍照，减少操作步骤
  - 拍照入口应始终可见，不因页面滚动而隐藏
- **随时随地探索**：
  - 支持在任何页面快速进入拍照模式
  - 拍照后可直接查看结果，无需返回首页
  - 支持快速切换：拍照 → 查看结果 → 继续拍照
  - 优化移动端性能，确保快速响应
- **响应式设计**：
  - 移动端优先设计，然后适配桌面端
  - 确保在小屏幕设备上的可用性（最小320px宽度）
  - 优化移动端加载速度和交互流畅度
  - 考虑移动端网络环境（弱网优化、离线支持）

## 技术约束

### Web 应用架构

- **项目类型**：Web 应用（前端 + 后端）
- **目标平台**：现代浏览器（支持桌面和移动端）
- **响应式设计**：必须支持多种屏幕尺寸，适配平板和手机

### 开发标准

- **代码质量**：遵循最佳实践，代码可读可维护
- **性能要求**：页面加载时间合理，交互响应流畅
- **安全性**：保护用户数据，特别是儿童隐私数据
- **可访问性**：考虑无障碍访问需求

## 治理规则

### 规范优先级

本规范优先于所有其他开发实践和指南。所有代码审查、设计评审和实现决策必须验证是否符合本规范。

### 修订流程

1. **版本管理**：遵循语义化版本（MAJOR.MINOR.PATCH）
   - MAJOR：不兼容的原则变更或移除
   - MINOR：新增原则或重大扩展
   - PATCH：澄清、措辞修正、非语义性改进

2. **修订要求**：
   - 任何原则变更必须记录在 Sync Impact Report 中
   - 修订后必须更新相关模板文件以确保一致性
   - 重大变更需要团队讨论和批准

3. **合规检查**：
   - 所有功能设计和实现计划必须通过规范检查
   - 违反规范的设计必须提供充分理由或调整方案

### 合规审查

- 在功能规划阶段（spec.md）必须验证是否符合所有原则
- 在实现计划阶段（plan.md）必须再次验证规范合规性
- 在任务执行前必须确认不违反任何原则

## 附录

### 相关文档

- 功能规范模板：`.specify/templates/spec-template.md`
- 实现计划模板：`.specify/templates/plan-template.md`
- 任务清单模板：`.specify/templates/tasks-template.md`

### 变更历史

- **v2.0.0** (2025-12-18)：重大更新，新增三条核心原则
  - 新增原则四：多语言和年级设置规范
  - 新增原则五：AI优先（模型优先）规范
  - 新增原则六：移动端优先规范
- **v1.0.0** (2025-12-18)：初始版本，建立三条核心原则
